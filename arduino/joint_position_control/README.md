# 关节位置控制程序

**专门为关节电机优化的位置控制系统**

## 🎯 项目特点

- ✅ 专业的关节位置控制
- ✅ 串口透传命令支持
- ✅ 平滑运动，减少振动
- ✅ 实时状态监控
- ✅ 完整错误检测

## 📱 串口命令

### 位置控制命令
```bash
pos 1.57       # 转到1.57弧度位置
angle 90       # 转到90度位置
speed 2.0      # 设置最大速度2.0 rad/s
```

### 控制命令
```bash
stop           # 停止电机
zero           # 设当前位置为零点
enable         # 使能电机
disable        # 禁用电机
status         # 显示详细状态
help           # 显示帮助
```

## 🔧 硬件连接

```
ESP32      CAN模块    小米电机
GPIO5  ←→ TX   ←→ CAN_H
GPIO4  ←→ RX   ←→ CAN_L
3.3V   ←→ VCC  ←→ 12-24V
GND    ←→ GND  ←→ GND
```

## 🚀 使用步骤

1. **Arduino IDE设置**
   - 开发板：ESP32 Dev Module
   - 安装库：ESP32-TWAI-CAN

2. **上传程序**
   - 打开 `joint_position_control.ino`
   - 选择串口并上传

3. **开始控制**
   - 打开串口监视器（115200）
   - 输入位置命令开始控制

## ⚙️ 关键参数

- **最大速度**: 3.0 rad/s（可调）
- **位置KP**: 30.0（减少振动）
- **速度KP**: 10.0
- **位置容差**: 0.05 rad

## 📊 状态监控

程序会实时显示：
- 当前位置（弧度和度数）
- 运动速度
- 扭矩输出
- 电机温度
- 错误状态

## 🛠️ 优势

1. **专业关节控制**：专门为关节应用优化
2. **防振动设计**：参数经过优化
3. **简单命令**：支持弧度和角度输入
4. **安全保护**：自动错误检测和处理
5. **透传控制**：直接串口命令控制

## 📋 适用场景

- 机器人关节控制
- 机械臂位置控制
- 舵机替代应用
- 精密角度定位

详细文档请参考父目录的 `ANTI_VIBRATION_GUIDE.md`